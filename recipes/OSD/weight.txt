#
# Принудительное изменение "веса" OSD 
#  (посмотреть веса можно "ceph osd df", "ceph osd tree")
#

ceph osd crush reweight osd.0 1

#
# Изменение весов OSD с расчета их объема и текущей занятости 
# (В данном случае меняется параметр  вторичного взвешивания REWEIGHT, а не WEIGHT)
#
ceph osd test-reweight-by-utilization    # Проверка ребалансировки без изменения.
ceph osd reweight-by-utilization	 # Ребалансировка (изменение параметров вторичного взвешивания)

#
# Ребалансировка  с использованием MGR/balancer
# (рекомендуется запуск в ненагруженное время)
#

ceph config-key set mgr/balancer/max_misplaced .07   	# (пример 7%) Настройка порога, при котором балансировшик будет распределять данные
ceph mgr module enable balancer				# Активация плагина MGR/balancer (не запускает процесса балансировки)
ceph balancer mode crush-compat				# Тип балансировки приближен к CRUSHMAPу
ceph balancer on					# Запуск процесса балансировки данных